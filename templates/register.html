{% extends "base.html" %}
{% set active = "reg" %}
{% block title %}Register{% endblock %}
{% block header %}Register{% endblock %}

{% block content %}
<form method="get" class="mb-4">
  <input type="hidden" name="month" value="{{ month }}">
  <select name="account" onchange="this.form.requestSubmit()"
          class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500">
    <option value="">Select account...</option>
    {% for a in accounts %}
    <option value="{{ a }}" {% if a == account %}selected{% endif %}>{{ a }}</option>
    {% endfor %}
  </select>
</form>

{% if rows %}
<div class="space-y-2">
  {% set ns = namespace(current_date='') %}
  {% for r in rows %}
  {% if r.date != ns.current_date %}
    {% set ns.current_date = r.date %}
    <div class="flex items-center gap-3 {% if not loop.first %}mt-4{% endif %} mb-2">
      <div class="flex-1 border-t border-gray-600"></div>
      <span class="text-sm font-medium text-gray-300 whitespace-nowrap">{{ r.date }}</span>
      <div class="flex-1 border-t border-gray-600"></div>
    </div>
  {% endif %}
  <div class="bg-gray-900 border border-gray-800 rounded-lg p-3">
    <div class="text-sm font-medium mb-1 break-words">{{ r.description }}</div>
    <div class="flex justify-between text-xs">
      <span class="text-gray-400 truncate mr-2">{{ r.account }}</span>
      {% if r.running %}
      <span class="font-mono whitespace-nowrap text-gray-500">= {{ r.running }}</span>
      {% else %}
      <span class="font-mono whitespace-nowrap">{{ r.amount }}</span>
      {% endif %}
    </div>
  </div>
  {% endfor %}
</div>
{% elif account %}
<p class="text-gray-500 text-center py-8">No entries for {{ account }}.</p>
{% else %}
<p class="text-gray-500 text-center py-8">Select an account above.</p>
{% endif %}
{% endblock %}
