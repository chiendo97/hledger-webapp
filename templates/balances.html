{% extends "base.html" %}
{% set active = "bal" %}
{% block title %}Balances{% endblock %}
{% block header %}Balances{% endblock %}

{% block content %}
{% include "partials/month_picker.html" %}
{% include "partials/depth_selector.html" %}
<form hx-get="/balances" hx-target="main" hx-swap="innerHTML" hx-select="main > *"
      class="mb-4">
  <input type="hidden" name="depth" value="{{ depth }}">
  <input type="text" name="q" value="{{ q }}" placeholder="Filter accounts..."
         class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"
         hx-get="/balances" hx-target="main" hx-trigger="keyup changed delay:300ms" hx-swap="innerHTML" hx-select="main > *"
         hx-include="[name=depth]">
</form>

<table class="w-full text-sm">
  <tbody>
  {% for row in rows %}
    <tr class="border-b border-gray-800 hover:bg-gray-900/50 cursor-pointer" onclick="window.location='/register?account={{ row.name }}{% if month %}&month={{ month }}{% endif %}'">
      <td class="py-2 pr-2 text-gray-400 break-words" style="padding-left: {{ row.depth * 12 }}px">{{ row.name }}</td>
      <td class="py-2 pl-2 font-mono text-right whitespace-nowrap">
        {% if row.amount_items|length > 1 %}
          {% for item in row.amount_items %}
          <div class="{% if item.startswith('-') %}text-red-400{% else %}text-green-400{% endif %}">{{ item }}</div>
          {% endfor %}
        {% else %}
          <span class="{% if row.amounts.startswith('-') %}text-red-400{% else %}text-green-400{% endif %}">{{ row.amounts }}</span>
        {% endif %}
      </td>
    </tr>
  {% else %}
    <tr><td colspan="2" class="text-gray-500 text-center py-8">No data.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
